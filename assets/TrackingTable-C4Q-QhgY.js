import{i as f,_,o as l,c as o,a,t as s,w as r,v as y,d as c,F as d,r as p,x as b,q as g}from"./index-V0BQvkh0.js";class m{constructor(t="http://localhost:3000/api/user/reader"){this.api=f(t)}async getAll(){try{return(await this.api.get("/")).data}catch(t){return console.log(t),null}}async getOne(t){try{return(await this.api.get("/get-one/"+t)).data}catch(i){return console.log(i),null}}async getQuantity(){return(await this.api.get("/quantity")).data}async updateData(t,i){return(await this.api.put("/get-one/"+t,i,{headers:{"Content-Type":"multipart/form-data"}})).data}async deleteUser(t){return(await this.api.delete("/get-one/"+t)).data}async changePassword(t,i,u,h){return(await this.api.put("/get-one/changepassword/"+t,{username:i,old:u,new:h},{headers:{"Content-Type":"multipart/form-data"}})).data}}const E=new m;class k{constructor(t="http://localhost:3000/api/tracking"){this.api=f(t)}async getAll(){return(await this.api.get("/")).data}async getAllByFilter(t){return(await this.api.get("/",{params:t})).data}async getOne(t){return(await this.api.get("/get-one/"+t)).data}async acceptRequest(t){return(await this.api.post("/get-one/accept/"+t)).data}async refuseRequest(t){return console.log(t),(await this.api.delete("/get-one/"+t)).data}async acceptReturn(t){return(await this.api.put("/get-one/"+t)).data}}const I=new k,C={name:"TrackingTable",props:["data","nextTable","tableLabel","acceptRequest","refuseRequest"],data(){return{tableCols:["ID","Book","Reader","Request Date","Borrowed Date","Term","Returned Date","Action"],filter:"",filtedData:[],count:1}},methods:{filterData(){this.filtedData=this.data.filter(n=>n.tensach.toLowerCase().includes(this.filter.toLowerCase())||n.tendocgia.toLowerCase().includes(this.filter.toLowerCase())||n._id.toLowerCase().includes(this.filter.toLowerCase())||n.masach.toLowerCase().includes(this.filter.toLowerCase())||n.madocgia.toLowerCase().includes(this.filter.toLowerCase())),console.log(this.data)},refreshBooks(){this.filtedData=this.data}},mounted(){this.filterData(),console.log(new Date),console.log(this.data)}},D={class:"m-4"},v={class:"d-flex"},L={class:"col-md-8"},R={class:"table border overflow-auto"},q={class:"table-dark"},T=a("th",null,null,-1),B=["title"],x=["title"],S=["onClick"],A=a("i",{class:"fa-regular fa-circle-check"},null,-1),$=[A],F=["onClick"],U=a("i",{class:"fa-regular fa-circle-xmark"},null,-1),M=[U];function O(n,t,i,u,h,V){return l(),o("div",D,[a("form",v,[a("h4",L,s(this.tableLabel),1),r(a("input",{class:"form-control me-2",type:"search",placeholder:"Search","aria-label":"Search","onUpdate:modelValue":t[0]||(t[0]=e=>this.filter=e)},null,512),[[y,this.filter]]),a("button",{class:"btn btn-outline-success",type:"submit",onClick:t[1]||(t[1]=c((...e)=>this.filterData&&this.filterData(...e),["prevent"]))}," Load ")]),a("table",R,[a("thead",q,[a("tr",null,[T,(l(!0),o(d,null,p(this.tableCols,e=>(l(),o("th",{scope:"col",key:e,class:""},s(e),1))),128))])]),a("tbody",null,[(l(!0),o(d,null,p(this.filtedData,(e,w)=>(l(),o("tr",{scope:"row",key:e},[a("td",null,s(w+1),1),a("td",null,s(e._id),1),a("td",{title:e.masach},s(e.tensach),9,B),a("td",{title:e.madocgia},s(e.tendocgia),9,x),a("td",null,s(e.ngayyeucau),1),a("td",null,s(e.ngaymuon),1),a("td",{class:b(new Date(e.hantra)<new Date&&e.hantra!==null?"border border-danger":"")},s(e.hantra),3),a("td",null,s(e.ngaytra),1),a("td",null,[a("div",null,[r(a("button",{class:"btn btn-success",onClick:c(async()=>{await this.acceptRequest(e._id),this.refreshBooks()},["prevent"])},$,8,S),[[g,e.trangthai!="returned"&&this.acceptRequest!==null]]),r(a("button",{class:"btn btn-danger",onClick:c(async()=>{await this.refuseRequest(e._id),this.refreshBooks()},["prevent"])},M,8,F),[[g,this.refuseRequest!==null&&e.trangthai!="borrowing"]])])])]))),128))])])])}const N=_(C,[["render",O]]);export{N as T,I as b,E as u};
